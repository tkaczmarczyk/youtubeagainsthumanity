<!DOCTYPE html>

<html ng-app="yahApp">
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.min.js"></script>
	<title>Youtube Against Humanity</title>


  <script type="text/javascript">
    angular.module('yahApp', [])
      .controller('YAHController', function() {
        var context = this;
        
        context.captureSnapshot = function() {
          video = document.querySelector('video');
          canvas = document.querySelector('canvas');
          canvasContext = canvas.getContext('2d');
          
          canvasContext.drawImage(video, 0, 0);
          context.lastSnapshotAsDataUrl = canvas.toDataURL('image/jpeg');
        };
        
        angular.element(document).ready(function () {
    			var video = document.querySelector('video');
    			navigator.getUserMedia  = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

    			if (navigator.getUserMedia) {
    			  navigator.getUserMedia({audio: false, video: true}, function(stream) {
  			      video.src = window.URL.createObjectURL(stream);
    			  }, errorCallback);
    			} else {
    		   // fallback.
    			}
        });
      });
  </script>
</head>
<body ng-controller="YAHController as context">
  <video autoplay id="video_preview"></video>
  <canvas style="display:none;"></canvas>
  <button ng-click="context.captureSnapshot()">Snap</button>

  <img ng-src="{{context.lastSnapshotAsDataUrl}}" id="captured_frame" />
</body>
</html>